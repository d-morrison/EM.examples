<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EM.examples">
<title>mixmodel-benchmark-r • EM.examples</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="mixmodel-benchmark-r">
<meta property="og:description" content="EM.examples">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EM.examples</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/McLachlan-p-17.html">McLachlan-p-17</a>
    <a class="dropdown-item" href="../articles/bin-mix-bin.html">bin-mix-bin</a>
    <a class="dropdown-item" href="../articles/mixmodel-benchmark-r.html">mixmodel-benchmark-r</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/d-morrison/EM.examples/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>mixmodel-benchmark-r</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/d-morrison/EM.examples/blob/HEAD/vignettes/mixmodel-benchmark-r.Rmd" class="external-link"><code>vignettes/mixmodel-benchmark-r.Rmd</code></a></small>
      <div class="d-none name"><code>mixmodel-benchmark-r.Rmd</code></div>
    </div>

    
    
<p>This R code defines an Expectation-Maximization (EM) algorithm to
estimate the parameters of a mixture of two Gaussian distributions. The
EM algorithm is an iterative method for finding the maximum likelihood
estimates of parameters in models with latent (unobserved) variables.
The Gaussian mixture model in this code assumes that the observed data,
Y, is generated from either one of two Gaussian distributions with means
mu[1] and mu[2] and a common standard deviation sigma. The probability
of the data coming from the first Gaussian distribution is pi, while the
probability of the data coming from the second Gaussian distribution is
1 - pi.</p>
<p>The gen_data function generates data according to this Gaussian
mixture model, while the fit_model function performs the EM algorithm.
The E_step function calculates the expected value of the log-likelihood
given the current estimates of the parameters and the observed data,
while the M_step updates the estimates of the parameters based on the
expected log-likelihood. The algorithm continues to iterate until the
difference in the log-likelihood between consecutive iterations is less
than a specified tolerance (tolerance). The results of the algorithm are
saved in a progress tibble that shows the values of the estimated
parameter pi-hat and the log-likelihood for each iteration.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">gen_data</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">n</span> <span class="op">=</span> <span class="fl">500000</span>,</span>
<span>    <span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">sigma</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="va">pi</span> <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    Obs.ID <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>,</span>
<span>    Z <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>    Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mean <span class="op">=</span> <span class="va">mu</span><span class="op">[</span><span class="va">Z</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Z</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      `p(Y=y|Z=1)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>,</span>
<span>      `p(Y=y|Z=2)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">mu</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu">gen_data</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500000</span>, pi <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table style="width:62%;" class="table">
<colgroup>
<col width="12%">
<col width="13%">
<col width="18%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">Obs.ID</th>
<th align="center">Y</th>
<th align="center">p(Y=y|Z=1)</th>
<th align="center">p(Y=y|Z=2)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">0.2415</td>
<td align="center">0.3875</td>
<td align="center">0.08499</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-0.4071</td>
<td align="center">0.3672</td>
<td align="center">0.02202</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">0.01312</td>
<td align="center">0.3989</td>
<td align="center">0.05542</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">2.756</td>
<td align="center">0.008952</td>
<td align="center">0.2999</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">-0.4597</td>
<td align="center">0.3589</td>
<td align="center">0.01937</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">1.505</td>
<td align="center">0.1286</td>
<td align="center">0.3529</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fit_model</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">data</span>,</span>
<span>    <span class="va">`p(Z=1)`</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># initial guess for `pi-hat`</span></span>
<span>    <span class="va">tolerance</span> <span class="op">=</span> <span class="fl">0.00001</span>,</span>
<span>    <span class="va">max_iterations</span> <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    <span class="va">verbose</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># pre-allocate a table of results by iteration:</span></span>
<span>  <span class="va">progress</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      Iteration <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">max_iterations</span>,</span>
<span>      `p(Z=1)` <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>      loglik <span class="op">=</span>  <span class="cn">NA_real_</span>,</span>
<span>      diff_loglik <span class="op">=</span> <span class="cn">NA_real_</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># initial E step, to perform needed calculations for initial likelihood:</span></span>
<span>  <span class="va">data</span> <span class="op">=</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">E_step</span><span class="op">(</span>`p(Z=1)` <span class="op">=</span> <span class="va">`p(Z=1)`</span><span class="op">)</span> </span>
<span>  <span class="va">ll</span> <span class="op">=</span> <span class="fu">loglik</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">progress</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">`p(Z=1)`</span>, <span class="va">ll</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">max_iterations</span><span class="op">)</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="co"># M step: re-estimate parameters</span></span>
<span>    <span class="va">`p(Z=1)`</span> <span class="op">=</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">M_step</span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># E step: re-compute distribution of missing variables, using parameters</span></span>
<span>    <span class="va">data</span> <span class="op">=</span> <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">E_step</span><span class="op">(</span>`p(Z=1)` <span class="op">=</span> <span class="va">`p(Z=1)`</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Assess convergence</span></span>
<span>    </span>
<span>    <span class="co">## save the previous log-likelihood so we can test for convergence</span></span>
<span>    <span class="va">ll_old</span> <span class="op">=</span> <span class="va">ll</span></span>
<span>    </span>
<span>    <span class="co">## here's the new log-likelihood</span></span>
<span>    <span class="va">ll</span> <span class="op">=</span> <span class="fu">loglik</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">ll_diff</span> <span class="op">=</span> <span class="va">ll</span> <span class="op">-</span> <span class="va">ll_old</span></span>
<span>    </span>
<span>    <span class="va">progress</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">`p(Z=1)`</span>, <span class="va">ll</span>, <span class="va">ll_diff</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">verbose</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">progress</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">ll_diff</span> <span class="op">&lt;</span> <span class="va">tolerance</span><span class="op">)</span> <span class="kw">break</span>;</span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">progress</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">E_step</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">`p(Z=1)`</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      `p(Y=y, Z=1)` <span class="op">=</span> <span class="va">`p(Y=y|Z=1)`</span> <span class="op">*</span> <span class="va">`p(Z=1)`</span>,</span>
<span>      `p(Y=y, Z=2)` <span class="op">=</span> <span class="va">`p(Y=y|Z=2)`</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">`p(Z=1)`</span><span class="op">)</span>,</span>
<span>      `p(Y=y)`      <span class="op">=</span> <span class="va">`p(Y=y, Z=1)`</span> <span class="op">+</span> <span class="va">`p(Y=y, Z=2)`</span>,</span>
<span>      `p(Z=1|Y=y)`  <span class="op">=</span> <span class="va">`p(Y=y, Z=1)`</span> <span class="op">/</span> <span class="va">`p(Y=y)`</span>,</span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">M_step</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`p(Z=1|Y=y)`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">loglik</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`p(Y=y)`</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Finally, the <code><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time()</a></code> function is used to measure
the time it takes to run the <code>fit_model()</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">{</span><span class="va">results</span> <span class="op">=</span> <span class="fu">fit_model</span><span class="op">(</span><span class="va">data</span>, tolerance <span class="op">=</span> <span class="fl">0.00001</span><span class="op">)</span><span class="op">}</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.942   0.040   0.983</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    Iteration `p(Z=1)`   loglik diff_loglik</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         0    0.5   -<span style="color: #BB0000; text-decoration: underline;">877</span><span style="color: #BB0000;">590.</span>    <span style="color: #BB0000;">NA</span>   <span style="color: #949494;"> </span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         1    0.665 -<span style="color: #BB0000; text-decoration: underline;">837</span><span style="color: #BB0000;">000.</span>     4.06<span style="color: #949494;">e</span>+4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         2    0.738 -<span style="color: #BB0000; text-decoration: underline;">828</span><span style="color: #BB0000;">034.</span>     8.97<span style="color: #949494;">e</span>+3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         3    0.770 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">959.</span>     2.07<span style="color: #949494;">e</span>+3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         4    0.785 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">455.</span>     5.05<span style="color: #949494;">e</span>+2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         5    0.793 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">328.</span>     1.27<span style="color: #949494;">e</span>+2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         6    0.797 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">295.</span>     3.24<span style="color: #949494;">e</span>+1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         7    0.799 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">287.</span>     8.36<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         8    0.800 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">285.</span>     2.17<span style="color: #949494;">e</span>+0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>         9    0.800 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     5.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        10    0.800 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     1.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>        11    0.800 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     3.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>        12    0.800 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     9.92<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>        13    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     2.58<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>        14    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     6.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>        15    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     1.75<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>        16    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     4.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>        17    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     1.19<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>        18    0.801 -<span style="color: #BB0000; text-decoration: underline;">825</span><span style="color: #BB0000;">284.</span>     3.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span></span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Douglas Ezra Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
